---
import BaseLayout from "@lib/layouts/BaseLayout.astro";
import Rect from "@lib/components/svg/builtin/Rect.astro";
import AnimateTransform from "@lib/components/svg/animations/AnimateTransform.astro";
import G from "@lib/components/svg/builtin/G.astro";
import Animate from "@lib/components/svg/animations/Animate.astro";

const dur1 = 500;
const dur2 = 50;
---

<BaseLayout title="playground:connect" fullScreen={true}>
  <svg viewBox="0 0 200 200">
    <G translate={[100, 100]}>
      <G transform="scale(1 1) rotate(90) translate(-5 -25)">
        <Rect fill={"red"} opacity={0.1} x={1} y={1} width={8} height={48}>
          <Animate attributeName="fill" values="red;blue;red" begin="last.end" dur="250ms" repeatCount={1} />
        </Rect>
        <Rect stroke="black" stroke-dasharray={"2 1"} stroke-width={0.5} fill={"none"} width={10} height={50}>
          <animate attributeName="stroke-dashoffset" from="0" to="3" dur="1s" repeatCount="indefinite"></animate>
        </Rect>
        <G color="black" shape-rendering="crispEdges">
          <G>
            <Rect width={5} height={50}>
              <AnimateTransform id="first" begin={"0s;last.end"} type="scale" dur={dur1} from="1 1" to="1 0.5" repeatCount={1} fill="freeze" />
              <animate begin="first.end" attributeName="opacity" from="1" to="0.5" dur="1ms" calcMode="discrete" fill="freeze"></animate>
              <AnimateTransform id="second" begin={"first.end"} type="translate" dur={dur1} from="0 0" to="0 50" repeatCount={1} fill="freeze" additive="sum" />
              <AnimateTransform begin="second.end" type="translate" dur={dur1} from="0 50" to="0 50" repeatCount={1} fill="freeze" additive="sum" />
              <AnimateTransform id="last" begin={"second.end"} type="scale" dur={dur1} from="1 1" to="1 2" repeatCount={1} fill="freeze" additive="sum" />
              <AnimateTransform begin="second.end" type="translate" dur={dur1} from="0 -50" to="0 -50" repeatCount={1} fill="freeze" additive="sum" />
              <animate begin="last.end" attributeName="opacity" from="0.5" to="1" dur="1ms" calcMode="discrete" fill="freeze"></animate>
            </Rect>
          </G>

          <G translate={[5, 50]}>
            <Rect width={5} height={50} y={-50}>
              <AnimateTransform id="first" begin={"0s;last.end"} type="scale" dur={dur2} from="1 1" to="1 0.5" repeatCount={1} fill="freeze" />
              <AnimateTransform
                id="second"
                begin={"first.end"}
                type="translate"
                dur={dur2}
                from="0 0"
                to="0 -50"
                repeatCount={1}
                fill="freeze"
                additive="sum"
              />
              <AnimateTransform begin="second.end" type="translate" dur={dur2} from="0 -50" to="0 -50" repeatCount={1} fill="freeze" additive="sum" />
              <AnimateTransform id="last" begin={"second.end"} type="scale" dur={dur2} from="1 1" to="1 2" repeatCount={1} fill="freeze" additive="sum" />
              <AnimateTransform begin="second.end" type="translate" dur={dur2} from="0 50" to="0 50" repeatCount={1} fill="freeze" additive="sum" />
            </Rect>
          </G>
        </G>
      </G>
    </G>
  </svg>
</BaseLayout>

<style>
  svg {
    width: 100%;
    height: 100%;
    border: 1px currentColor dashed;
  }
</style>
