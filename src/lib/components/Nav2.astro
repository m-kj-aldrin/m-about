---
import Icon, { IconTypes } from "./Icon.astro";
import { Replace } from "../types/util";
const url = Astro.url;

type TopPaths = "/" | "/works/" | "/about/";

// const paths: TopPaths[] = ["/", "/works/", "/about/"];
const paths: { path: TopPaths; name: string }[] = [
    { path: "/", name: "home" },
    { path: "/works/", name: "works" },
    // { path: "/about/", name: "about" },
];

type CleanPath = Replace<Exclude<"/", TopPaths>, "/", "">;

const re = /\/works\/.+/;
const work = re.test(url.pathname);
---

<nav>
    <ul>
        {
            paths.map(({ path, name }, i) => {
                const worksSubDir = work && path == "/works/";

                const iconType: IconTypes =
                    path == "/"
                        ? "home"
                        : worksSubDir
                          ? "back"
                          : (path.replaceAll("/", "") as CleanPath);

                return (
                    <li>
                        <a
                            href={path}
                            aria-current={url.pathname == path ? "page" : null}
                            aria-label={worksSubDir && "back to works page"}
                            title={name}
                        >
                            <Icon name={iconType} />
                        </a>
                    </li>
                );
            })
        }
    </ul>
</nav>

<style>
    a {
        display: block;
        line-height: 0;
        /* outline: 1px red solid; */
        transition: color 75ms ease;
    }
    nav {
        background-color: hsla(var(--color-light), 0.9);

        padding: 6px 16px;

        border-radius: 4px;
        align-self: center;
        margin-inline: auto;

        margin-top: 16px;
        margin-bottom: 20px;

        box-shadow:
            0 0 16px 8px hsla(var(--color-dark), 0),
            inset 0 0 12px 2px hsla(var(--color-primary), 0.05);
        border: 1px hsl(var(--color-primary), 0.1) dashed;
    }
    ul {
        display: flex;
        gap: 8px;
    }

    [aria-current="page"],
    [aria-label="back to works page"] {
        color: hsl(var(--color-offset));
    }
</style>
